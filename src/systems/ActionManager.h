////////////////////////////////////////////////////////////
// Preprocessor directives
////////////////////////////////////////////////////////////
#pragma once

////////////////////////////////////////////////////////////
// Headers
////////////////////////////////////////////////////////////
#include "actions.h"
#include <SFML/Window/Keyboard.hpp>
#include <SFML/Window/Mouse.hpp>
#include <bitset>
#include <map>
#include <nlohmann/json.hpp>

using json = nlohmann::json;

namespace steamrot {

class ActionManager {
private:
  ////////////////////////////////////////////////////////////
  // |Member: stores key mappings to actions for this scene
  ////////////////////////////////////////////////////////////
  std::map<std::bitset<sf::Keyboard::KeyCount + sf::Mouse::ButtonCount>,
           Actions>
      m_key_to_action_map;

  ////////////////////////////////////////////////////////////
  // |brief: returns map of string letters to sf::Keyboard enum
  ////////////////////////////////////////////////////////////
  static const std::map<std::string, sf::Keyboard::Key>
  getStringToKeyboardMap();

  ////////////////////////////////////////////////////////////
  // |brief: returns map of string letters to sf::Mouse enum
  ////////////////////////////////////////////////////////////
  static const std::map<std::string, sf::Mouse::Button> getStringToMouseMap();

  ////////////////////////////////////////////////////////////
  // |brief register actions for object instance from json
  ////////////////////////////////////////////////////////////
  void RegisterActions(json &congig);

public:
  ////////////////////////////////////////////////////////////
  // |brief constructor using json as configuration object
  ////////////////////////////////////////////////////////////
  ActionManager(json &config);

  ////////////////////////////////////////////////////////////
  // |brief Generate any possible actions for this scene as bitflag enum
  ////////////////////////////////////////////////////////////
  const Actions GenerateActions(
      std::bitset<sf::Keyboard::KeyCount + sf::Mouse::ButtonCount>);
};
} // namespace steamrot
