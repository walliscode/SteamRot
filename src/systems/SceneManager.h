////////////////////////////////////////////////////////////
// preprocessor directives
////////////////////////////////////////////////////////////
#pragma once

////////////////////////////////////////////////////////////
// headers
////////////////////////////////////////////////////////////
#include "AssetManager.h"
#include "DataManager.h"

#include "SceneFactory.h"
#include "TexturesPackage.h"
#include "uuid.h"
#include <SFML/Graphics.hpp>
#include <SFML/Window/Event.hpp>

#include <memory>
#include <nlohmann/json.hpp>
#include <unordered_map>

using json = nlohmann::json;

namespace steamrot {

class SceneManager {
private:
  ////////////////////////////////////////////////////////////
  // Member data
  ////////////////////////////////////////////////////////////
  SceneFactory m_scene_factory;

  ////////////////////////////////////////////////////////////
  // |brief map of uuid to Scene
  ////////////////////////////////////////////////////////////
  std::unordered_map<uuids::uuid, std::unique_ptr<Scene>> m_scenes;
  AssetManager m_asset_manager;

  DataManager m_data_manager;

public:
  ////////////////////////////////////////////////////////////
  /// \brief Default constructor
  ///
  ////////////////////////////////////////////////////////////
  SceneManager();

  ////////////////////////////////////////////////////////////
  /// \brief start up the SceneManager for the game
  ///
  ////////////////////////////////////////////////////////////
  void StartUp();

  ////////////////////////////////////////////////////////////
  /// \brief Update all Scenes
  ///
  ////////////////////////////////////////////////////////////
  void UpdateScenes();

  ////////////////////////////////////////////////////////////
  /// \brief Add a new scene from default data
  ///
  ////////////////////////////////////////////////////////////
  void AddSceneFromDefault(const SceneType &scene_type, size_t pool_size);

  ////////////////////////////////////////////////////////////
  /// \brief collate textures from relevant scenes and provide as package
  ////////////////////////////////////////////////////////////
  TexturesPackage ProvideTexturesPackage();
};

} // namespace steamrot
